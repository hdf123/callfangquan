<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta name="format-detection" content="telephone=yes"/>
		<title>搜索</title>
		<link rel="stylesheet" type="text/css" href="css/search.css"/>
		<script src="../js/js.js" type="text/javascript" charset="utf-8"></script>
		<script src="../js/time.js" type="text/javascript" charset="utf-8"></script>
	</head>
	<body>
		<header class="headers">
			<div>
				<i class="iconfont">&#xe641;</i>
				<input type="text" placeholder=" 搜索行家" />
			</div>
			<div onclick="history.back(-1)">取消</div>
			<!--<div onclick="history.go(-1)">取消</div>-->
		</header>
		<section class="contents">
			<!--<div class="contents_box">
				<div>
					<div>搜索历史</div>
					<i class="iconfont removek">&#xe646;</i>
				</div>
				<ul>
					<li>亚新美好天境</li>
					<li>瀚海尔湾</li>
				</ul>
			</div>-->
			<div class="without">
				<div>
					<i class="iconfont">&#xe641;</i>
					<p>没有任何搜索历史</p>
				</div>
			</div>
			<ul class="results">
				<li class="connoisseur_box">
					<div>
						<div class="connoisseur">
							<div>
								<img src="" alt="" />
								<img src="../img/vip.png" alt="" />
							</div>
							<div>
								<h3>张志军1</h3>
								<p>新合鑫置业 董事长</p>
								<div>筑美好人居 享丰盛人生</div>
							</div>
						</div>
						<div class="guanzhu cancel">√已关注</div>
					</div>
					<div class="questions">
						<div>
							<div>向TA咨询</div>
						</div>
						<div>
							<div>TA的回答(<span>18</span>)</div>
						</div>
					</div>
				</li>
				<li class="connoisseur_box">
					<div>
						<div class="connoisseur">
							<div>
								<img src="" alt="" />
								<img src="../img/vip.png" alt="" />
							</div>
							<div>
								<h3>张志军2</h3>
								<p>新合鑫置业 董事长</p>
								<div>筑美好人居 享丰盛人生</div>
							</div>
						</div>
						<div class="guanzhu Care_about">
							<i class="iconfont">&#xe609;</i>关注
						</div>
					</div>
					<div class="questions">
						<div>
							<div>向TA咨询</div>
						</div>
						<div>
							<div>TA的回答(<span>18</span>)</div>
						</div>
					</div>
				</li>
				<li class="connoisseur_box">
					<div>
						<div class="connoisseur">
							<div>
								<img src="" alt="" />
								<img src="../img/vip.png" alt="" />
							</div>
							<div>
								<h3>张志军3</h3>
								<p>新合鑫置业 董事长</p>
								<div>筑美好人居 享丰盛人生</div>
							</div>
						</div>
						<div class="guanzhu Care_about">
							<i class="iconfont">&#xe609;</i>关注
						</div>
					</div>
					<div class="questions">
						<div>
							<div>向TA咨询</div>
						</div>
						<div>
							<div>TA的回答(<span>18</span>)</div>
						</div>
					</div>
				</li>
				<li class="connoisseur_box">
					<div>
						<div class="connoisseur">
							<div>
								<img src="" alt="" />
								<img src="../img/vip.png" alt="" />
							</div>
							<div>
								<h3>1张志军4</h3>
								<p>新合鑫置业 董事长</p>
								<div>筑美好人居 享丰盛人生</div>
							</div>
						</div>
						<div class="guanzhu Care_about">
							<i class="iconfont">&#xe609;</i>关注
						</div>
					</div>
					<div class="questions">
						<div>
							<div>向TA咨询</div>
						</div>
						<div>
							<div>TA的回答(<span>18</span>)</div>
						</div>
					</div>
				</li>
			</ul>
		</section>
<script type="text/javascript">
$(function(){
	var call_record = JSON.parse(localStorage.getItem('call_record'));
	console.log(call_record);
	if(call_record==null){
		var call_record=[];
	}else{
		$(".without").hide();//历史为空
		$(".contents>ul").hide();//搜索结果
		var record="";
		for(i in call_record){
			record+=`<li class="record">${call_record[i]}</li>`;
		}
		$(".contents").append(`<div class="contents_box">
								<div>
									<div>搜索历史</div>
									<i class="iconfont removek">&#xe646;</i>
								</div>
								<ul>${record}</ul>
							</div>`)
	}
	$(".contents").on("click",".removek",function(){
		$(".contents_box").hide();//历史记录
		localStorage.removeItem('call_record');
		$(".without").show();
	})
	$('.headers input').on('keypress', function (e){
	    var keycode = e.keyCode;
	　　//keycode是键码，13也是电脑物理键盘的 enter
	    if(keycode == '13') {
	    	e.preventDefault();
	    	console.log("texts="+$(this).val());
	    	call_record.push($(this).val())
	    	//数组去重
	    	call_record=heavy(call_record);
	    	localStorage.setItem('call_record', JSON.stringify(call_record));
	    	search($(this).val());
	    }
	});
	$(".contents").on("click",".record",function(){
		search($(this).html());
	})
	
	function search(ss){
		$(".without").hide();//历史为空
	    $(".contents_box").hide();//历史记录
	    $(".contents>ul").show();//搜索结果
  		var sd= $(".results").find('h3:contains('+ ss +')').closest(".connoisseur_box");
  		console.log(sd.length);
  		if(sd.length<1){
  			alert("没有你要搜索的结果，请重新输入");
  		}
  		$(".results").html(sd);
	}
})
</script>
	</body>
</html>
